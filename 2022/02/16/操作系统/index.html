

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="操作系统 1.概述1.1 操作系统简介​    定义：位于用户层和底层硬件之间的一层，目的是：  1.管理底层的硬件资源，协调硬件的资源，使得不同的部分组合在一起拥有更强大的功能。 文件管理 内存管理 进程管理 设备管理   2.提供给用户&#x2F;程序员接口： 用户： GUI – 图形界面 命令接口 cmd：联机命令接口 bat文件：脱机命令接口     程序员：系统调用    1.2操作系统">
<meta property="og:type" content="article">
<meta property="og:title" content="操作系统">
<meta property="og:url" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="操作系统 1.概述1.1 操作系统简介​    定义：位于用户层和底层硬件之间的一层，目的是：  1.管理底层的硬件资源，协调硬件的资源，使得不同的部分组合在一起拥有更强大的功能。 文件管理 内存管理 进程管理 设备管理   2.提供给用户&#x2F;程序员接口： 用户： GUI – 图形界面 命令接口 cmd：联机命令接口 bat文件：脱机命令接口     程序员：系统调用    1.2操作系统">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212094555081.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212112201718.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212113442182.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212113701444.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212225124372.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213123547242.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213132126787.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213135040011.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213144610261.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213144600005.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213160142949.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213160229617.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213160431015.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213161125817.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213203126361.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213321140.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213205942.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213144911.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213547855.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220214152243194.png">
<meta property="og:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220214152418712.png">
<meta property="article:published_time" content="2022-02-15T18:28:40.310Z">
<meta property="article:modified_time" content="2022-02-15T18:28:40.311Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212094555081.png">
  
  
  <title>操作系统 - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="操作系统">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-02-16 02:28" pubdate>
        February 16, 2022 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.6k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      39 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">操作系统</h1>
            
            <div class="markdown-body">
              <p>操作系统</p>
<h1 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h1><h2 id="1-1-操作系统简介"><a href="#1-1-操作系统简介" class="headerlink" title="1.1 操作系统简介"></a>1.1 操作系统简介</h2><p>​    定义：位于用户层和底层硬件之间的一层，目的是：</p>
<ul>
<li>1.管理底层的硬件资源，协调硬件的资源，使得不同的部分组合在一起拥有更强大的功能。<ul>
<li>文件管理</li>
<li>内存管理</li>
<li>进程管理</li>
<li>设备管理</li>
</ul>
</li>
<li>2.提供给用户&#x2F;程序员接口：<ul>
<li>用户：<ul>
<li>GUI – 图形界面</li>
<li>命令接口<ul>
<li>cmd：联机命令接口</li>
<li>bat文件：脱机命令接口</li>
</ul>
</li>
</ul>
</li>
<li>程序员：系统调用</li>
</ul>
</li>
</ul>
<h2 id="1-2操作系统的特征"><a href="#1-2操作系统的特征" class="headerlink" title="1.2操作系统的特征"></a>1.2操作系统的特征</h2><p>​    四个特性：</p>
<ul>
<li>并发</li>
<li>共享</li>
<li>虚拟</li>
<li>异步</li>
</ul>
<p>​    其中并发和共享是基础。</p>
<p>​    区分两个概念：</p>
<ul>
<li>并发：多个程序交替执行，是时分复用的思想</li>
<li>并行：多个程序同时执行</li>
</ul>
<h2 id="1-3操作系统的分类"><a href="#1-3操作系统的分类" class="headerlink" title="1.3操作系统的分类"></a>1.3操作系统的分类</h2><p>​    大致分一下几个阶段：</p>
<ul>
<li>手工操作机器：写纸袋 – 输入纸袋 – 读取纸袋 – 计算 –  写出纸袋 – 输出纸袋 – 取纸袋。缺点是利用率太低了，各个阶段，无论是cpu还是io</li>
<li>批处理阶段<ul>
<li>单道批处理系统：类似于bat文件，将程序直接写好，用外围机将纸袋转换成磁带 ，然后用户输入磁带，等待机器计算完后输出磁带。具体的不住：输入磁带 – 计算 – 输出磁带。利用的技术是：脱机输入输出技术。也有缺点，资源利用率低，cpu计算时io是空闲的。</li>
<li>多道批处理系统：利用了流水线技术。缺点：无人机交互功能，一旦提交程序就无法修改或输入参数</li>
</ul>
</li>
<li>分时操作系统：时间片轮转为用户提供作业，用户可通过终端与计算机进行交互。缺点是OS太公平了，没有优先级之分，没人得到的任务时间都是一样的，无法处理紧急任务</li>
<li>实时操作系统:<ul>
<li>硬实时操作系统：导弹发射 – 严格执行，对ddl的要求很严格</li>
<li>软实时操作系统：订火车票 – 偶尔违反</li>
</ul>
</li>
<li>其它：网络操作系统，分布式操作系统，个人操作系统</li>
</ul>
<h2 id="1-4操作系统的运行机制"><a href="#1-4操作系统的运行机制" class="headerlink" title="1.4操作系统的运行机制"></a>1.4操作系统的运行机制</h2><p>​    <img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212094555081.png" srcset="/img/loading.gif" lazyload alt="image-20220212094555081"></p>
<h2 id="1-5中断和异常"><a href="#1-5中断和异常" class="headerlink" title="1.5中断和异常"></a>1.5中断和异常</h2><p>​    中断是唯一一种内核夺回cpu控制权的途径</p>
<p>​    中断分类：</p>
<ul>
<li>内中断：中断与当前执行的指令有关，也称为异常<ul>
<li>产生内中断的方式：执行非法的用户指令或参数非法，执行陷入指令（请求系统调用的时候会进行）</li>
</ul>
</li>
<li>外中断：与当前执行的指令无关<ul>
<li>产生外中断的方式：时钟中断（并发的实现），io中断（打印机打印完成）</li>
</ul>
</li>
</ul>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212112201718.png" srcset="/img/loading.gif" lazyload alt="image-20220212112201718"></p>
<h2 id="1-6系统调用与函数"><a href="#1-6系统调用与函数" class="headerlink" title="1.6系统调用与函数"></a>1.6系统调用与函数</h2><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212113442182.png" srcset="/img/loading.gif" lazyload alt="image-20220212113442182"></p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212113701444.png" srcset="/img/loading.gif" lazyload alt="image-20220212113701444"></p>
<p>​    系统调用能更好的去管理资源，因为很多资源的请求都是有条件的，共享也是在互斥的条件下才能共享的。</p>
<p>​    库函数是暴露给上层程序员的接口，而系统调用则是某些库函数在进行资源请求时的接口。</p>
<p>​    系统调用的过程：</p>
<ul>
<li>用户态：应用程序向寄存器中传入参数，指明想要那种系统调用</li>
<li>用户态：应用程序执行陷入指令，由用户态切换内核态</li>
<li>内核态：运行系统调用入口程序，检查寄存器中的参数，准备运行相对应的系统调用</li>
<li>内核态：运行响应的系统调用程序</li>
<li>用户态：返回用户态</li>
</ul>
<p>​    陷入指令 &#x3D; trap指令 &#x3D; 访管指令</p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220212225124372.png" srcset="/img/loading.gif" lazyload alt="image-20220212225124372"></p>
<h2 id="1-7操作系统体系结构"><a href="#1-7操作系统体系结构" class="headerlink" title="1.7操作系统体系结构"></a>1.7操作系统体系结构</h2><ul>
<li>大内核 &#x2F; 单内核 &#x2F; 宏内核</li>
<li>微内核</li>
</ul>
<p>微内核和大内核的一个比较重要的区别：微内核向OS请求服务需要经过6次状态改变，而大内核只需要经过2次状态改变</p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213123547242.png" srcset="/img/loading.gif" lazyload alt="image-20220213123547242"></p>
<p>​    所以微内核的性能比较低，但是内核维护的资源少一点</p>
<h1 id="2-进程管理"><a href="#2-进程管理" class="headerlink" title="2.进程管理"></a>2.进程管理</h1><h2 id="1-进程-amp-程序-amp-进程实体"><a href="#1-进程-amp-程序-amp-进程实体" class="headerlink" title="1.进程 &amp; 程序 &amp; 进程实体"></a>1.进程 &amp; 程序 &amp; 进程实体</h2><p>​    概念 – 组成 – 特征</p>
<p>​    进程和程序的区别：</p>
<ul>
<li>程序：是我们写死的，一系列的指令的集和，表示为一个可执行文件，是静态的</li>
<li>进程：是程序的一次执行，是动态的</li>
</ul>
<p>​    进程的组成：</p>
<ul>
<li>PCB（程序管理块）：OS管理用的</li>
<li>程序段：进程自己用的，程序代码</li>
<li>数据段：进程自己用的，程序运行产生的数据</li>
</ul>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213132126787.png" srcset="/img/loading.gif" lazyload alt="image-20220213132126787"></p>
<p>​    进程是程序的一次执行，是动态的，而进程实体，是在某一时刻进程的状态，包括PCB，程序段，数据段，这是静态的。</p>
<p>​    于是可以给进程下定义：进程是进程实体的整个运行过程，是系统进行资源分配与调度的基本单位</p>
<p>​    进程还有一些特征，不记录了</p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213135040011.png" srcset="/img/loading.gif" lazyload alt="image-20220213135040011"></p>
<h2 id="2-进程的状态与转换"><a href="#2-进程的状态与转换" class="headerlink" title="2.进程的状态与转换"></a>2.进程的状态与转换</h2><p>​    可以分为以下状态：</p>
<ul>
<li>创建状态：创建PCB，分配资源</li>
<li>就绪状态：资源1，处理机（CPU）0</li>
<li>运行状态：资源1，处理机1</li>
<li>阻塞状态：资源0，处理机0</li>
<li>终止状态：资源回收</li>
</ul>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213144610261.png" srcset="/img/loading.gif" lazyload alt="image-20220213144610261"></p>
<p>​    进程的管理有两种方法，一是队列的形式（指针），二是索引的形式</p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213144600005.png" srcset="/img/loading.gif" lazyload alt="image-20220213144600005"></p>
<h2 id="3-进程控制"><a href="#3-进程控制" class="headerlink" title="3.进程控制"></a>3.进程控制</h2><p>​    进程控制的工作：创建进程，撤销进程，进程状态转换。</p>
<p>​    用原语实现</p>
<p>​    原语的 原子性如何实现：通过“开 &#x2F; 关中断指令”。一旦执行了关中断指令，系统就不会去响应中断信号了。类似中断屏蔽机制。</p>
<h3 id="1-创建进程的原语"><a href="#1-创建进程的原语" class="headerlink" title="1.创建进程的原语"></a>1.创建进程的原语</h3><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213160142949.png" srcset="/img/loading.gif" lazyload alt="image-20220213160142949"></p>
<h3 id="2-撤销进程的原语"><a href="#2-撤销进程的原语" class="headerlink" title="2.撤销进程的原语"></a>2.撤销进程的原语</h3><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213160229617.png" srcset="/img/loading.gif" lazyload alt="image-20220213160229617"></p>
<h3 id="3-阻塞-x2F-唤醒进程的原语"><a href="#3-阻塞-x2F-唤醒进程的原语" class="headerlink" title="3.阻塞 &#x2F; 唤醒进程的原语"></a>3.阻塞 &#x2F; 唤醒进程的原语</h3><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213160431015.png" srcset="/img/loading.gif" lazyload alt="image-20220213160431015"></p>
<h3 id="4-切换进程原语"><a href="#4-切换进程原语" class="headerlink" title="4.切换进程原语"></a>4.切换进程原语</h3><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213161125817.png" srcset="/img/loading.gif" lazyload alt="image-20220213161125817"></p>
<h2 id="4-进程通信"><a href="#4-进程通信" class="headerlink" title="4.进程通信"></a>4.进程通信</h2><p>​    通过：共享存储，消息传递，管道通信实现</p>
<h3 id="1-共享存储"><a href="#1-共享存储" class="headerlink" title="1.共享存储"></a>1.共享存储</h3><p>​    进程之间的内存地址是只能有自己访问的。要想进程通信，可以再开辟一个单独的空间，归通信的进程所有，细分为两类。</p>
<ul>
<li>共享数据结构：只能存放一种特定的数据结构，通信慢，低级</li>
<li>共享存储区：在内存中单独分配一份空间，数据的类型，存放的位置由应用程序决定，不由OS决定，高速，高级</li>
</ul>
<p>​    无论哪种，进程对共享内存的访问都需要是互斥的</p>
<h3 id="2-管道通信"><a href="#2-管道通信" class="headerlink" title="2.管道通信"></a>2.管道通信</h3><p>​    以下几点：</p>
<ul>
<li>互斥访问</li>
<li>一个pipe只能半双工，要实现双工需要两个pipe</li>
<li>写满了会阻塞，只有写满了才能读，pipe不空不许写</li>
<li>最多一个进程读</li>
</ul>
<h3 id="3-消息传递"><a href="#3-消息传递" class="headerlink" title="3.消息传递"></a>3.消息传递</h3><ul>
<li>直接通信：直接将消息体加上消息头打包发出，然后OS给到对应进程的消息队列中去</li>
<li>间接通信（邮箱）：类似于web邮箱</li>
</ul>
<h2 id="5-线程"><a href="#5-线程" class="headerlink" title="5.线程"></a>5.线程</h2><h3 id="1-引入多线程"><a href="#1-引入多线程" class="headerlink" title="1.引入多线程"></a>1.引入多线程</h3><p>​    进程的出现是为了增加系统的并发度。多线程出现后，线程成为了系统调度的基本单位，进程只用于资源分配</p>
<p>​    线程和进程类似，有TCB（thread control block），TID（thread id）</p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213203126361.png" srcset="/img/loading.gif" lazyload alt="image-20220213203126361"></p>
<p>​    多线程引入后，相同进程的线程切换，开销少；不同进程的线程切换，开销依然大。</p>
<h3 id="2-线程的实现"><a href="#2-线程的实现" class="headerlink" title="2.线程的实现"></a>2.线程的实现</h3><ul>
<li>用户级线程（ULT）：用户自己来实现，并不由OS调度，通过app &amp; 线程库来对线程进行调度。<ul>
<li>优点：开销少，无需状态的切换</li>
<li>缺点：只能并发不能并行。并且单核多核一个样，因为核的调度单位是线程。然后若是碰上阻塞，那就阻塞了。</li>
</ul>
</li>
<li>内核级线程（kernel-level thread）：OS可以看到的线程，由OS调度<ul>
<li>优点：并发高，就算某线程阻塞了，可以通过内核的调度，去执行其它的线程</li>
<li>缺点：开销高，切换线程需要对应状态的改变。</li>
</ul>
</li>
</ul>
<h3 id="3-多线程模型"><a href="#3-多线程模型" class="headerlink" title="3.多线程模型"></a>3.多线程模型</h3><ul>
<li>一对一：一个用户级对应一个内核级</li>
</ul>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213321140.png" srcset="/img/loading.gif" lazyload alt="image-20220213213321140"></p>
<ul>
<li>多对一：多个用户级对应一个内核级，通过引入线程库实现。通过牺牲并发性来提高效率，一旦被阻塞就会over</li>
</ul>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213205942.png" srcset="/img/loading.gif" lazyload alt="image-20220213213205942"></p>
<ul>
<li>多对多（n : m）：n个用户及对应m个内核级，其中n&gt;&#x3D;m，这样就算某一个用户级线程被阻塞，其他用户线程也不会被阻塞。</li>
</ul>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213144911.png" srcset="/img/loading.gif" lazyload alt="image-20220213213144911"></p>
<p>​    总览：</p>
<p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220213213547855.png" srcset="/img/loading.gif" lazyload alt="image-20220213213547855"></p>
<h2 id="6-处理机调度"><a href="#6-处理机调度" class="headerlink" title="6.处理机调度"></a>6.处理机调度</h2><h3 id="1-作业"><a href="#1-作业" class="headerlink" title="1.作业"></a>1.作业</h3><p>​    作业就是任务。</p>
<p>​    当我们向OS提交一个作业，就是让OS启动一个程序。</p>
<p>​    三种调度方式。</p>
<h3 id="2-高级调度"><a href="#2-高级调度" class="headerlink" title="2.高级调度"></a>2.高级调度</h3><p>​    又称作业调度。</p>
<p>​    我们进行一个作业时，需要把程序从外存加载到内存，这个时候，首先将程序添加到外存 的<strong>准备队列（后备队列）</strong>中去进行排队，然后再按照<strong>调度算法</strong>将队列中的程序加载到内存，并且创建进程。</p>
<p>​    作业调入内存时会创建一次PCB，调出内存时撤销PCB。调入调出操作只执行一次</p>
<h3 id="3-低级调度"><a href="#3-低级调度" class="headerlink" title="3.低级调度"></a>3.低级调度</h3><p>​    又称进程调度 &#x2F; 处理机调度</p>
<p>​    前面的高级调度一般是在程序运行前。而低级调度是程序已经启动，操作对象是正在运行的进程 &#x2F; 进程实体。</p>
<p>​    具体是，根据<strong>调度算法</strong>选取进程就绪队列中的某一个进程，然后将CPU分配给它。</p>
<p>​    进程调度的使用频率很高，几十毫秒一次，是实现并发的关键。</p>
<h3 id="4-中级调度"><a href="#4-中级调度" class="headerlink" title="4.中级调度"></a>4.中级调度</h3><p>​    又称外内存调度。</p>
<p>​    引用场景是当OS发现内存不够了，会将后台暂时没有运行的进程挂到外存中去。被挂起的进程的PCB会形成挂起队列。等到要运行时OS再根据<strong>调度算法</strong>将队列中的PCB还回来，并且分配处理机。</p>
<p>​    中级调度发生的频率也比高级调度高。</p>
<h3 id="5-进程的7状态模型-amp-5状态模型对比"><a href="#5-进程的7状态模型-amp-5状态模型对比" class="headerlink" title="5.进程的7状态模型 &amp;5状态模型对比"></a>5.进程的7状态模型 &amp;5状态模型对比</h3><h4 id="7状态"><a href="#7状态" class="headerlink" title="7状态"></a>7状态</h4><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220214152243194.png" srcset="/img/loading.gif" lazyload alt="image-20220214152243194"></p>
<h4 id="5状态"><a href="#5状态" class="headerlink" title="5状态"></a>5状态</h4><p><img src="/2022/02/16/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/image-20220214152418712.png" srcset="/img/loading.gif" lazyload alt="image-20220214152418712"></p>
<h3 id="6-调度总结"><a href="#6-调度总结" class="headerlink" title="6.调度总结"></a>6.调度总结</h3><ul>
<li>高级调度：作业调度，频率低，外存 –&gt; 内存</li>
<li>低级调度：进程调度，频率高，内存 –&gt; CPU</li>
<li>中级调度：内存调度，频率中，内存 &lt; – &gt; 外存</li>
</ul>
<h2 id="7-进程调度详解"><a href="#7-进程调度详解" class="headerlink" title="7.进程调度详解"></a>7.进程调度详解</h2><h3 id="1-进程调度的时机"><a href="#1-进程调度的时机" class="headerlink" title="1.进程调度的时机"></a>1.进程调度的时机</h3><h4 id="1-需要进行进程调度的情况"><a href="#1-需要进行进程调度的情况" class="headerlink" title="1.需要进行进程调度的情况"></a>1.需要进行进程调度的情况</h4><ul>
<li>主动放弃CPU：<ul>
<li>进程正常终止</li>
<li>运行产生异常</li>
<li>io阻塞</li>
</ul>
</li>
<li>被动放弃CPU：<ul>
<li>时钟（时间片用完了）</li>
<li>更紧急的事件需要处理</li>
<li>更高优先级的进程进入就绪队列等待</li>
</ul>
</li>
</ul>
<h4 id="2-不能进行进程调度的情况"><a href="#2-不能进行进程调度的情况" class="headerlink" title="2.不能进行进程调度的情况"></a>2.不能进行进程调度的情况</h4><ul>
<li>处理中断</li>
<li>进程在操作系统内核程序临界区</li>
<li>原语（原子操作）</li>
</ul>
<p>​    临界资源：指一个时间段之内，只允许一个进程访问的资源。也就是需要互斥访问的资源。</p>
<p>​    临界区：访问临界资源的那一段代码。当访问临界资源时，代码会对临界资源进行上锁，确保其它进程不能同时访问临界资源；当进程离开临界区后，会对临界资源解锁。</p>
<p>​    内核临界区：一般是访问内核的某一个数据结构的代码，比如就绪队列。</p>
<p>​    所以，在内核资源临界区时不能进程调度，在普通临界区时是可以进程调度。考虑下面两个例子：</p>
<ul>
<li>进程在对内核中的队列进行操作（就绪队列，阻塞队列，阻塞挂起队列，就绪挂起队列）时，如果此时进行进程调度，夺取cpu，那么新来的进程要想进行工作，肯定也要对队列进行操作，如果是同一个队列，那么上锁了就产生了死锁。</li>
<li>进程等待打印机打印完成时，打印机时临界资源，也需要上锁。但是这时就可以进行进程调度了，因为不调度会空转cpu，调度的话也不会影响内核的工作，所以是ok的</li>
</ul>
<p>​    所以能否进行进程调度，关键问题还是之前的工作是否会对调度后的工作产生影响。（中断的话是在内核进行的，而原语也是内核的部分服务）</p>
<p>​    有的OS只能进程主动放弃CPU，有的OS会强制要求进程放弃CPU</p>
<h3 id="2-进程调度的方式"><a href="#2-进程调度的方式" class="headerlink" title="2.进程调度的方式"></a>2.进程调度的方式</h3><p>​    分为非剥夺调度方式和剥夺调度方式。</p>
<ul>
<li>非剥夺调度方式：非抢占式，只能进程自己放弃cpu，这种实现简单，开销少，但无法处理紧急任务。适合于批处理系统</li>
<li>剥夺调度方式：抢占式，可以由内核剥夺os，如果有优先级更高的或者时间片用完了。适合于分时，实时操作系统。</li>
</ul>
<h3 id="3-进程切换和进程调度"><a href="#3-进程切换和进程调度" class="headerlink" title="3.进程切换和进程调度"></a>3.进程切换和进程调度</h3><p>​    三个概念：</p>
<ul>
<li>进程切换：一个进程让出cpu，另一个进程得到cpu，注意，；俩进程不同</li>
<li>狭义进程调度：从就绪队列中选出一个进程，将cpu给到它。注意，这个进程可以是新的进程，也可以是原来被剥夺cpu的进程</li>
<li>广义进程调度：剥夺进程a的cpu，从就绪队列中选择一个进程b，将cpu赋予b</li>
</ul>
<p>​    进程切换的工作：</p>
<ul>
<li>保存剥夺cpu进程的pcb</li>
<li>恢复赋予cpu进程的pcb</li>
</ul>
<p>​    pcb中包含程序状态字，计数器，还有各种寄存器的信息。</p>
<p>​    从上看来，进程调度还是很有代价的。如果过于频繁的切换进程的话，系统的效率会下降。</p>
<h2 id="8-调度算法的性能指标"><a href="#8-调度算法的性能指标" class="headerlink" title="8.调度算法的性能指标"></a>8.调度算法的性能指标</h2><h3 id="1-cpu利用率"><a href="#1-cpu利用率" class="headerlink" title="1.cpu利用率"></a>1.cpu利用率</h3><p>​    计算：忙碌时间➗总运行时间</p>
<p>​    io设备的利用率也是这样算的。</p>
<h3 id="2-系统吞吐量"><a href="#2-系统吞吐量" class="headerlink" title="2.系统吞吐量"></a>2.系统吞吐量</h3><p>​    定义：单位时间完成作业的数量。</p>
<p>​    计算：总共完成多少道作业➗总花费时间</p>
<h3 id="3-周转时间"><a href="#3-周转时间" class="headerlink" title="3.周转时间"></a>3.周转时间</h3><p>​    定义：作业被提交到系统开始，到完成作业为止的时间。</p>
<p>​    计算：作业完成时间 - 作业提交时间</p>
<p>​    平均值计算：作业周转时间之和 ➗ 作业数</p>
<p>​    注意，周转时间包含了等待的时间在里面。</p>
<p>​    我们引出了带权周转时间：</p>
<p>​    计算：作业周转时间 ➗ 作业实际运行时间，注意，这个值大于等于1，越接近1对用户而言体验越好。</p>
<p>​    也有平均带权周转时间，计算类似前面。</p>
<h3 id="4-等待时间"><a href="#4-等待时间" class="headerlink" title="4.等待时间"></a>4.等待时间</h3><p>​    定义：作业等待处理机所消耗的时间。注意！这里严格的来讲不能将处理机视作cpu，因为处理机既可以是cpu核心，也可以是io设备，如打印机等。</p>
<p>​    这对进程和作业而言是两种计算：</p>
<ul>
<li>进程：指的是进程被建立后，从进入就绪队列开始，到进程结束，等待处理机服务的总时间。包括在就绪队列的时间，但不包括等待io的时间。如进程等待打印机打印，进程实际是被打印机服务的，所以不算等待时间。</li>
<li>作业：除了进程的等待时间，还要算上作业在从外存加入内存前，在后备队列上等待高级调度（作业调度）的时间。</li>
</ul>
<h3 id="5-响应时间"><a href="#5-响应时间" class="headerlink" title="5.响应时间"></a>5.响应时间</h3><p>​    定义：用户从首次提交请求到首次得到响应的时间，算作一次响应时间。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">计算机网络-自顶向下</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/02/14/rust-lang/">
                        <span class="hidden-mobile">rust-lang</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
